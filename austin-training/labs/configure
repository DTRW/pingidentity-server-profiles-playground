#!/bin/bash
THIS="$( basename "${0}" )"
cd "$( dirname "${0}" )"
DOT_PINGIDENTITY="${HOME}/.pingidentity"
test -d "${DOT_PINGIDENTITY}" || mkdir -p "${DOT_PINGIDENTITY}"

################################################################################
# Check for a .pingidentity directory with propertyfile
################################################################################
PROPS_FILE="${DOT_PINGIDENTITY}/austin.properties"
test -f "${PROPS_FILE}" && source "${PROPS_FILE}"


################################################################################
# Print usage information
################################################################################
function usage()
{
cat <<EO_USAGE

Usage: ${THIS} [ configure ]

Examples

    ${THIS}

EO_USAGE

  exit
}

################################################################################
# Allow the user to interactively provide configuraiton information to be 
# set to .pingidentity/ldapsdk.properties file
################################################################################
function configure()
{
  echo "
###############################################################################################
#                                 ${THIS} Configuration
###############################################################################################
#
# This will create properties in ${PROPS_FILE}
# and they will be used as environment variables for scripts, .yamls, etc...
#
# To edit these in the future simply run: ./${THIS}
# or edit the property file directory.
###############################################################################################
"
  DEVOPS_IN_BASE=$( cd ..; pwd )
  DEVOPS_OUT_BASE="/tmp/austin"

  echo -n "Docker Container DEVOPS_IN_BASE  local base [${DEVOPS_IN_BASE}] ? "
  read answer
  ! test -z "${answer}" && DEVOPS_IN_BASE="${answer}"
  echo -n "Docker Container DEVOPS_OUT_BASE local base [${DEVOPS_OUT_BASE}] ? "
  read answer
  ! test -z "${answer}" && DEVOPS_OUT_BASE="${answer}"

  ! test -z "${DEVOPS_IN_BASE}" && echo "export DEVOPS_IN_BASE=${DEVOPS_IN_BASE}" > ${PROPS_FILE}
  ! test -z "${DEVOPS_OUT_BASE}" && echo "export DEVOPS_OUT_BASE=${DEVOPS_OUT_BASE}" >> ${PROPS_FILE}

  . ${PROPS_FILE}
}

configure


echo "
To use these properties, source then in your .bash_profile. And restart your shell:

  echo \". ${PROPS_FILE}\" >> ~/.bash_profile

Or source it into your current shell:

  . ${PROPS_FILE}
"
